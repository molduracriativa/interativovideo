<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convite Interativo</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#000}

/* ===== VIDEO ===== */
#video{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:1;
}

/* ===== AUDIO ===== */
#audio{display:none}

/* ===== TEXTO CONVIDADO ===== */
#footerInvite{
  position:absolute;
  bottom:6%;
  width:100%;
  text-align:center;
  color:#fff;
  font-family:Arial,sans-serif;
  z-index:5;
  opacity:0;
  transform:translateY(20px);
  transition:.8s;
  pointer-events:none;
}
#footerInvite.show{
  opacity:1;
  transform:translateY(0);
}
#footerInvite span{
  display:block;
  margin-top:6px;
  font-size:18px;
}

/* ===== DEBUG ===== */
.debug{background:rgba(255,0,0,.35)}

/* ===== CLIQUE VIDEO 1 ===== */
#video1Click{
  position:absolute;
  inset:0;
  z-index:10;
}

/* ===== CONTROLES ===== */
#audioControl{
  position:absolute;
  top:15px;
  left:15px;
  width:80px;
  height:80px;
  z-index:20;
  display:none;
}
#menuToggle,#backToVideo2{
  position:absolute;
  top:15px;
  right:15px;
  width:120px;
  height:80px;
  z-index:20;
  display:none;
}

/* ===== MENU ===== */
#menu{
  position:absolute;
  right:0;
  top:70%;
  transform:translateY(-50%);
  width:300px;
  height:520px;
  background:url("media/menu.png") no-repeat right center;
  background-size:contain;
  display:none;
  z-index:15;
  pointer-events:none;
}
.menu-hotspot{
  position:absolute;
  right:35px;
  width:90px;
  height:70px;
  cursor:pointer;
  pointer-events:auto;
}
#btn1{top:95px}
#btn2{top:195px}
#btn3{top:295px}

/* ===== MAPS VIDEO 3 ===== */
#mapsHotspot{
  position:absolute;
  left:50%;
  bottom:200px;
  transform:translateX(-50%);
  width:320px;
  height:120px;
  z-index:20;
  display:none;
}

/* ===== CRONÔMETRO VIDEO 4 ===== */
#countdown{
  position:absolute;
  left:50%;
  bottom:200px;
  transform:translateX(-50%);
  display:none;
  z-index:20;
  color:#fff;
  font-family:Arial,sans-serif;
}
.count-grid{
  display:flex;
  gap:14px;
  text-align:center;
}
.count-box{
  min-width:70px;
}
.count-num{
  font-size:28px;
  font-weight:bold;
}
.count-label{
  font-size:12px;
  margin-top:4px;
}
</style>
</head>

<body>

<video id="video" autoplay muted playsinline preload="auto"></video>
<audio id="audio" src="media/audio.mp3" loop preload="auto"></audio>

<div id="video1Click"></div>
<div id="footerInvite"></div>

<div id="audioControl" class="debug"></div>
<div id="menuToggle" class="debug"></div>
<div id="backToVideo2" class="debug"></div>

<div id="menu">
  <div id="btn1" class="menu-hotspot debug" onclick="goVideo(3)"></div>
  <div id="btn2" class="menu-hotspot debug" onclick="goVideo(4)"></div>
  <div id="btn3" class="menu-hotspot debug" onclick="goVideo(5)"></div>
</div>

<a id="mapsHotspot"
   class="debug"
   href="https://maps.app.goo.gl/AZBjKdxYEqVsC6N38"
   target="_blank"></a>

<!-- CRONÔMETRO -->
<div id="countdown">
  <div class="count-grid">
    <div class="count-box">
      <div class="count-num" id="d">00</div>
      <div class="count-label">Dias</div>
    </div>
    <div class="count-box">
      <div class="count-num" id="h">00</div>
      <div class="count-label">Horas</div>
    </div>
    <div class="count-box">
      <div class="count-num" id="m">00</div>
      <div class="count-label">Min</div>
    </div>
    <div class="count-box">
      <div class="count-num" id="s">00</div>
      <div class="count-label">Seg</div>
    </div>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const LOOP_START = 11;
const EVENT_DATE = "2026-08-20T18:00:00";
let video2FirstPlay = true;
let countdownInterval;

const convidados = [
 "Drika","Andressa","Ramon","Myrtes","Thais",
 "Marcela","Tatiane","Kelly","Katia","Aline"
];

const video = document.getElementById("video");
const audio = document.getElementById("audio");
const footer = document.getElementById("footerInvite");
const clickV1 = document.getElementById("video1Click");
const audioCtrl = document.getElementById("audioControl");
const menuToggle = document.getElementById("menuToggle");
const menu = document.getElementById("menu");
const backBtn = document.getElementById("backToVideo2");
const mapsHotspot = document.getElementById("mapsHotspot");
const countdown = document.getElementById("countdown");

/* ===== RESET ===== */
function resetVideoEvents(){
  video.onended = null;
  video.ontimeupdate = null;
  video.onloadedmetadata = null;
  clearInterval(countdownInterval);
}

/* ===== LOAD VIDEO ===== */
function loadVideo(n, fromReturn=false){
  resetVideoEvents();

  video.src = `media/video${n}.mp4`;
  video.load();
  video.play();

  footer.classList.remove("show");
  clickV1.style.display = n===1 ? "block":"none";
  audioCtrl.style.display = n===2 ? "block":"none";
  menuToggle.style.display = n===2 ? "block":"none";
  menu.style.display = "none";
  backBtn.style.display = n>=3 ? "block":"none";
  mapsHotspot.style.display = n===3 ? "block":"none";
  countdown.style.display = n===4 ? "block":"none";

  if(n===1) showInviteWithDelay();

  if(n===4) startCountdown();

  /* ===== VIDEO 2 ===== */
  if(n===2){
    if(video2FirstPlay && !fromReturn){
      video.onended = ()=> video.pause();
      video2FirstPlay = false;
    }else{
      video.onloadedmetadata = ()=>{
        video.currentTime = LOOP_START;
      };
      video.ontimeupdate = ()=>{
        if(video.currentTime >= video.duration - 0.2){
          video.currentTime = LOOP_START;
        }
      };
    }
  }

  /* ===== VIDEOS 3,4,5 ===== */
  if(n>=3){
    video.onended = ()=>{
      video.currentTime = 0;
      video.play();
    };
  }
}

/* ===== CRONÔMETRO ===== */
function startCountdown(){
  const target = new Date(EVENT_DATE).getTime();

  countdownInterval = setInterval(()=>{
    const now = Date.now();
    const diff = target - now;

    if(diff <= 0) return;

    const d = Math.floor(diff / (1000*60*60*24));
    const h = Math.floor((diff / (1000*60*60)) % 24);
    const m = Math.floor((diff / (1000*60)) % 60);
    const s = Math.floor((diff / 1000) % 60);

    document.getElementById("d").textContent = String(d).padStart(2,"0");
    document.getElementById("h").textContent = String(h).padStart(2,"0");
    document.getElementById("m").textContent = String(m).padStart(2,"0");
    document.getElementById("s").textContent = String(s).padStart(2,"0");
  },1000);
}

/* ===== INICIO ===== */
loadVideo(1);

/* ===== CLIQUE VIDEO 1 ===== */
clickV1.onclick = ()=>{
  audio.play();
  loadVideo(2);
};

/* ===== TEXTO ===== */
function showInviteWithDelay(){
  const nome = new URLSearchParams(location.search).get("nome");
  if(nome && convidados.includes(nome)){
    setTimeout(()=>{
      footer.innerHTML = `<strong>${nome},</strong>
      <span>Este convite foi preparado<br>especialmente para você</span>`;
      footer.classList.add("show");
    },1000);
  }
}

/* ===== SOM ===== */
audioCtrl.onclick = e=>{
  e.stopPropagation();
  audio.paused ? audio.play() : audio.pause();
};

/* ===== MENU ===== */
menuToggle.onclick = e=>{
  e.stopPropagation();
  menu.style.display = menu.style.display==="block"?"none":"block";
};

/* ===== RETORNO ===== */
backBtn.onclick = ()=>{
  loadVideo(2,true);
};

/* ===== NAVEGAÇÃO ===== */
function goVideo(n){
  loadVideo(n);
}
</script>

</body>
</html>
